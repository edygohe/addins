<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Consulta Vehículos</title>
</head>
<body>
  <h2>Vehículos activos v1.0.0</h2>
  <ul id="vehicleList"></ul>

  <script>
    geotab.addin.consultaVehiculos = function(api, state) {
      return {
        initialize: function (api, state, callback) {
          api.call("Get", {
            typeName: "Device",
            resultsLimit: 10
          }).then(function (devices) {
            const ul = document.getElementById("vehicleList");
            devices.forEach(device => {
              const li = document.createElement("li");
              li.textContent = device.name;
              ul.appendChild(li);
            });
            callback(); // muy importante para que MyGeotab no falle
          }).catch(function (err) {
            console.error("Error al obtener dispositivos", err);
            callback();
          });
        }
      };
    };
  </script>
</body>
</html>
